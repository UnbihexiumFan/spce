<!DOCTYPE html>
<html lang="en">
<head>
  <title id="title"></title>
  <style>
    .comic {
      display: block;
      margin-left: auto;
      margin-right: auto;
      border: 2px;
      border-color: black;
      border-style: solid;
    }
    .comic-title {
      text-align: center;
      font-size: 20pt;
      font-weight: bold;
      font-family: Helvetica;
    }
    .button {
      border: 2px;
      border-color: black;
      border-style: solid;
      color: black;
      cursor: pointer;
      text-align: center;
      text-decoration: none;
      display: inline-block;
    }
    .button:hover {
      background-color: #25b;
      color: white;
    }
    .text {
      text-align: center;
      font-size: 10pt;
    }
  </style>
</head>
<body>
  <div class="comic-title" id="comic-title"></div>
  <div class="text">
    <button class="button" onclick=Prev()>&lt;&lt;</button>
    <button class="button" onclick=Next()>&gt;&gt;</button>
  </div>
  <br/>
  <img class="comic" src="comics/1.png" id="comic-image" title="Oh crap! If you're seeing this, then something has gone horribly wrong!" style="width:42px;"/>
  <pre id="output"></pre>
  <script>
    async function getData() {
      const response = await fetch('https://unbihexiumfan.github.io/spce/image_properties.json');
      const data = await response.json();
      return data;
    }
    getData().then((data) => {
        const dataArray = JSON.parse(data);
    });
    //const data = '{"max-comic":3,"1":{"title": "Hydrogen","mouseover": "Your chemistry textbooks are WRONG! Hydrogen doesn\'t want two electrons in its outer shell. It doesn\'t want zero electrons in its outer shell. It just wants a friend.","width": 300},"2":{"title": "Helium","mouseover": "He... he... he...","width": 350},"3":{"title": "Lithium","mouseover": "Fun fact: Any other element in place of lithium would either be lying or lyeing. I\'ll let you figure out what that means.","width": 500}}';
    const params = new URLSearchParams(window.location.search);
    var index = Number(params.get("id"));
    if (index == 0) {
      index = dataArray["max-comic"]
    }
    function Prev() {
      if (index > 1) {
        index -= 1;
        Update();
      }
    }
    function Next() {
      if (index < dataArray["max-comic"]) {
        index += 1;
      }
      Update();
    }
    function Update() {
      document.getElementById("comic-image").src = "comics/"+index+".png";
      params.set("id", index)

      const newUrl = `${window.location.pathname}?${params.toString()}`;
      window.history.replaceState({}, "", newUrl); // update the URL without reloading
      document.getElementById("comic-title").innerHTML = "#"+index.toString()+"- "+dataArray[index.toString()]["title"];
      document.getElementById("title").innerHTML = "SPCE "+index.toString()+": "+dataArray[index.toString()]["title"];
      document.getElementById("comic-image").style = "max-width:"+dataArray[index.toString()]["width"]+"px;";
      document.getElementById("comic-image").title = dataArray[index.toString()]["mouseover"];
    }
    Update();
  </script>
</body>
</html>
